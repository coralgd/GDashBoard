btn.onclick = async () => {
  const nickValue = input.value.trim();
  if(nickValue.length < 3){
    error.textContent = 'Ник слишком короткий';
    return;
  }

  // Проверка уникальности ника
  const q = query(collection(db,'users'), where('nick','==',nickValue));
  const snap = await getDocs(q);
  if(!snap.empty){
    error.textContent = 'Такой ник уже занят';
    return;
  }

  // Создаём документ только с ником и почтой
  await setDoc(doc(db,'users',user.uid), {
    nick: nickValue,
    email: user.email
  });

  // Перенаправляем на main
  location.href='main.html';
};
